---
title: git学习(4):自定义git
date: 2017-01-31 15:17:21
tags: git
categories: git
---
### 自定义git
我们还可以自定义很多git的配置项，比如，让git显示颜色，这样可以让命令行更加醒目：
```bash
git config --global color.ui true
```
#### 忽略特殊文件
有的时候，我们有一些文件放在git工作目录中，但是我们又不想把这些文件上传到远程仓库，比如说生成的文件之类的。
我们可以在工作目录的根目录下创建一个`.gitignore`文件，在里面填写需要忽略的文件就可以了。最后，我们需要把`.gitignore`也推送到远程仓库。
忽略文件的原则是：
1.忽略操作系统自动生成的文件，比如缩略图等；
2.忽略编译生成的中间文件、可执行文件等，也就是如果一个文件是通过另一个文件自动生成的，那自动生成的文件就没必要放进版本库，比如Java编译产生的.class文件；
3.忽略你自己的带有敏感信息的配置文件，比如存放口令的配置文件。
#### 配置别名
比如`git status`这个命令，我们想用`git st`来表示，我们可以使用如下命令：
```bash
git config --global alias.st status
```
同理，其他命令也可以这样处理。注意的是，`--config`是全局变量，对于这台计算机的当前用户，修改后的命令都通用。如果不加这个参数的话，修改后的命令只对当前仓库生效。每个仓库的配置文件都存放在`.git/config`里，而别名就在`[alias]`之后。当前用户的git配置文件则存放在用户主目录的`.gitconfig`里。如果想要修改别名，直接修改这两个配置文件也可以。
#### 搭建git服务器
把远程服务器托管到github上是一个不错的选择，但是如果我们不交钱的话，我们的项目所有人都可以访问，就很没有隐私。如果我们即想隐藏自己的项目，也不想给万恶的美帝交钱的话，自己搭建一个`git`服务器无疑是一个更好的选择。
我们前面说过，远程仓库其实和本地仓库是没有区别的，只是方便大家进行版本交换，所以搭建起来也很简单。我们需要一台`linux`系统的机器，搭建`git`服务器的话需要一台`linux`系统的机器，廖大推荐使用`buntu`或`Debian`，这样，通过几条`apt`命令就可以很快搭建了。
我们需要一个有`sudo`权限的账户，然后简单几步安装。
第一步，安装`git`：
```bash
sudo apt-get install git
```
d第二步，创建一个`git`账户，来运行`git`服务：
```bash
sudo adduser git
```
第三步，创建证书登录：
把所有要推送到这个远程仓库的用户的公钥收集过来，就类似于在`github`中的ssh认证一样，放在`/home/git/.ssh/authorized_keys`文件里，一行一个。
第四步，初始化Git仓库：
需要一个文件夹作为`git`的仓库，假设是假定是`/srv/test.git`，在`/srv`目录下输入命令：
```bash
sudo git init --bare test.git
```
这样子`git`会建立一个裸仓库，裸仓库是没有工作区的，所有`git`服务器不允许用户上来直接更改文件。而且服务器上的仓库通常以`.git`结尾。接下来我们把`owner`也改成`git`:
```bash
sudo chown -R git:git test.git
```
第五步，禁用shell登录：
为了安全，原则上，我们禁止`git`用户能通过`shell`登录。我们找到`/etc/passwd`文件，把其中的一行
```bash 
git:x:1001:1001:,,,:/home/git:/bin/bash
```
改成
```bash
git:x:1001:1001:,,,:/home/git:/usr/bin/git-shell
```
这样处理之后，`git`用户只能通过`ssh`推送`git`，不能够通过`shell`登录到服务器。
这样子，`git`服务器就搭建好了，我们可以像使用`github`一样使用他了。
#### 管理公钥和权限
廖大说，用`Gitosis`可以管理公钥。用`Gitolite`可以让`git`拥有像svn一样的权限。这两个我都还没有接触，暂且不表，等有机会的时候在尝试一下。
