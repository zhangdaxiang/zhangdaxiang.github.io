---
title: 枚举类和元类
date: 2016-11-24 10:03:13
tags: python
categories: python
---
### 枚举类
#### 定义
如果我们定义的类的属性是有限且固定的，我们可以使用枚举类。
我们首先要从`enum`模块中导入`Enum`，然后在定义类的时候继承`Enum`：
```python
from enum import Enum
class Weekday(Enum):
	Sunday = 1
	Monday = 2
	Tuesday = 3
	Wednesday = 4
	Thursday = 5
	Friday = 6
	Saturday = 7
```
这样我们就成功定义了星期的枚举类`Weekday`，他有固定的7个成员，比如`Weekday.Sunday`,`Weekday.Monday`等。而且每个成员都有他固定名称和值，比如说`Weekday.Sunday`的名称是`Sunday`，值是1。而且之前我们就知道，我们定义的类也是一种数据类型，和`list`,`str`这些数据类型没有任何区别。所以，每个成员的数据类型，都是他们所属于的枚举类。
有几点需要注意一下：
1.成员的名称不允许重复：
```python
from enum import Enum
class Weekday(Enum):
	Sunday = 1
	Sunday = 2
```
这样子会有报错`TypeError: Attempted to reuse key: 'Sunday'`。
2.成员的值一般情况下是可以相同的。两个值相同的成员，第二个成员会视为第一个成员的别名：
```python
class Weekday(Enum):
	Sunday = 1
	Sunday_two = 1
```
`Weekday.Sunday`和`Sunday_two`具有相同的值，所以`Sunday_two`是作为`Sunday`的别名存在的。而且如果我们想获取值相同的成员，只能取到第一个。
3.如果我们想限制枚举类，希望不能有重复值，可以使用`@unique`这个装饰器：
```python
from enum import Enum,unique

@unique
class Weekday(Enum):
	Sunday = 1
	Sunday_two = 1
```
这样就会报重复值的错误`ValueError: duplicate values found in <enum 'Weekday'>: Sunday_two -> Sunday`。
#### 枚举取值
可以直接通过成员名称来获取成员：
```python
>>> Weekday['Sunday']
<Weekday.Sunday: 1>
```
通过成员的值来获取成员：
```python
>>> Weekday(1)
<Weekday.Sunday: 1>
```
也可以通过成员来取他的名称和值：
```python
>>> Week = Weekday.Sunday
>>> Week.name
'Sunday'
>>> Week.value
1
```
还可以使用`for`循环来遍历整个`Weekday`枚举类。但是如果有重复值，只会遍历第一个成员：
```python
from enum import Enum
class Weekday(Enum):
	Sunday = 1
	Monday = 2
	Tuesday = 3
	Wednesday = 4
	Thursday = 5
	Friday = 6
	Saturday = 7
	Sunday_two = 1

for i in Weekday:
	print(i)

#输出
Weekday.Sunday
Weekday.Monday
Weekday.Tuesday
Weekday.Wednesday
Weekday.Thursday
Weekday.Friday
Weekday.Saturday
```
如果我们希望重复的值也被遍历出来，可以加一个魔法方法`__members__`：
```python
for i in Weekday.__members__.items():
	print(i)

#输出
('Sunday', <Weekday.Sunday: 1>)
('Monday', <Weekday.Monday: 2>)
('Tuesday', <Weekday.Tuesday: 3>)
('Wednesday', <Weekday.Wednesday: 4>)
('Thursday', <Weekday.Thursday: 5>)
('Friday', <Weekday.Friday: 6>)
('Saturday', <Weekday.Saturday: 7>)
('Sunday_two', <Weekday.Sunday: 1>)
```
#### 枚举成员比较
可以用`is,is not`和`==,!=`进行比较，但是不能比较大小：
```python
>>> Weekday.Sunday is Weekday.Sunday
True
>>> Weekday.Sunday is not Weekday.Monday
True
>>> Weekday.Sunday == Weekday.Sunday
True
>>> Weekday.Sunday != Weekday.Sunday
False
```
